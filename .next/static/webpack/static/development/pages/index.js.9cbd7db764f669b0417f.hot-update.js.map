{"version":3,"file":"static/webpack/static/development/pages/index.js.9cbd7db764f669b0417f.hot-update.js","sources":["webpack:///./pages/index.jsx"],"sourcesContent":["import { useMachine } from \"@xstate/react\";\nimport Router from \"next/router\";\nimport { useState } from \"react\";\nimport { assign, Machine } from \"xstate\";\nimport Layout from \"../components/Layout\";\nimport Calendar from \"../features/schedule/components/Calendar\";\nimport TimeBar from \"../features/schedule/components/TimeBar\";\nimport firebase from \"../sideEffects/firebase\";\nimport Next from \"../static/svg/NextStep.jsx\";\n\nconst createMeeting = async event => {\n  const { payload } = event;\n\n  const newDoc = await firebase\n    .firestore()\n    .collection(\"meetings\")\n    .add({ options: JSON.stringify(payload) })\n    .catch(error => error);\n\n  return newDoc.id;\n};\n\nconst scheduleMachine = Machine({\n  id: \"schedule\",\n  initial: \"calendar\",\n  states: {\n    calendar: {\n      on: { CONFIRMED_DATES: \"times\" }\n    },\n    times: {\n      on: {\n        CONFIRMED_TIMES: \"loading\",\n        ADDED_NEW_DATE: \"calendar\"\n      }\n    },\n    loading: {\n      invoke: {\n        id: \"createMeeting\",\n        src: (context, event) => createMeeting(event),\n        onDone: {\n          target: \"ready\",\n          actions: assign({ slug: (context, event) => event.data })\n        },\n        onError: {\n          target: \"failure\",\n          actions: assign({ error: (context, event) => event.data })\n        }\n      }\n    },\n    ready: {\n      on: { SELECTED_A_DATE: \"confirmed\" }\n    },\n    confirmed: {\n      type: \"final\"\n    },\n    failure: { type: \"final\" }\n  }\n});\n\nconst propTypes = {};\n\nconst defaultProps = {};\n\nconst getInitialProps = async () => {\n  const meetings = await firebase\n    .firestore()\n    .collection(\"meetings\")\n    .get()\n    .then(collection => collection.docs.map(doc => doc.data()))\n    .catch(error => error);\n\n  return { meetings };\n};\n\nexport default function index({ meetings }) {\n  const tomorrow = new Date(\n    new Date(new Date().setDate(new Date().getDate() + 1)).setHours(0, 0, 0, 0)\n  );\n\n  const [dates, setDates] = useState({\n    [tomorrow]: [[13, 14]]\n  });\n\n  const [current, send] = useMachine(scheduleMachine);\n  console.log(\"current\", current);\n  return (\n    <Layout>\n      <section className=\"vh-100 vw-100 flex flex-column items-center justify-around pa0 ma0\">\n        {current.value === \"calendar\" && (\n          <>\n            <h1 className=\"f1\">Pick up to 3 dates to meet...</h1>\n            <Calendar handleSelect={setDates} dates={dates} />\n            <Next\n              action={() => send(\"CONFIRMED_DATES\")}\n              className=\"pointer grow\"\n            />\n          </>\n        )}\n\n        {current.value === \"times\" && (\n          <>\n            <TimeBar dates={dates} send={send} setDates={setDates} />\n            <Next\n              action={() => send({ type: \"CONFIRMED_TIMES\", payload: dates })}\n              className=\"pointer grow gray\"\n            />\n          </>\n        )}\n        {current.value === \"ready\" && Router.push(\"/meet/123\")}\n      </section>\n    </Layout>\n  );\n}\n\nindex.propTypes = propTypes;\nindex.defaultProps = defaultProps;\nindex.getInitialProps = getInitialProps;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAMA;AAAA;AACA;AAAA;AACA;AARA;AAGA;AAHA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAWA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AADA;AAGA;AACA;AACA;AACA;AAFA;AADA;AAMA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAFA;AAIA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAFA;AAPA;AADA;AAcA;AACA;AAAA;AAAA;AADA;AAGA;AACA;AADA;AAGA;AAAA;AAAA;AA9BA;AAHA;AAqCA;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAPA;AACA;AADA;AAQA;AAAA;AACA;AATA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAUA;AAAA;AACA;AACA;AAFA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AASA;AACA;AAEA;AAAA;AAGA;AAAA;AACA;AAAA;AAAA;AAEA;AAAA;AAAA;AACA;AAFA;AASA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAFA;AAUA;AAEA;AACA;AACA;;;;A","sourceRoot":""}