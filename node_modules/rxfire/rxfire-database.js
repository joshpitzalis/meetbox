!function(v,l,c){"use strict";function f(n,r){return new l.Observable(function(t){var e=n.on(r,function(e,n){t.next({snapshot:e,prevKey:n,event:r})},t.error.bind(t));return{unsubscribe:function(){n.off(r,e)}}}).pipe(c.delay(0))}var e;(e=v.ListenEvent||(v.ListenEvent={})).added="child_added",e.removed="child_removed",e.changed="child_changed",e.moved="child_moved",e.value="value";var r=function(){return(r=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)};function p(e){var n="function"==typeof Symbol&&e[Symbol.iterator],t=0;return n?n.call(e):{next:function(){return e&&t>=e.length&&(e=void 0),{value:e&&e[t++],done:!e}}}}function t(e,n){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var r,i,o=t.call(e),a=[];try{for(;(void 0===n||0<n--)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(t=o.return)&&t.call(o)}finally{if(i)throw i.error}}return a}function h(){for(var e=[],n=0;n<arguments.length;n++)e=e.concat(t(arguments[n]));return e}function i(e){return null!=e&&0!==e.length||(e=[v.ListenEvent.added,v.ListenEvent.removed,v.ListenEvent.changed,v.ListenEvent.moved]),e}function o(e,n){var t;return r({},e.snapshot.val(),n?((t={})[n]=e.snapshot.key,t):null)}function a(u,e){var n,s=i(e);return(n=u,l.from(n.once(v.ListenEvent.value)).pipe(c.map(function(e){return{snapshot:e,prevKey:null,event:v.ListenEvent.value}}))).pipe(c.switchMap(function(e){var n,t,r=[l.of(e)];try{for(var i=p(s),o=i.next();!o.done;o=i.next()){var a=o.value;r.push(f(u,a))}}catch(e){n={error:e}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(n)throw n.error}}return l.merge.apply(void 0,h(r)).pipe(c.scan(y,[]))}),c.distinctUntilChanged())}function d(e,n){for(var t=e.length,r=0;r<t;r++)if(e[r].snapshot.key===n)return r;return-1}function y(t,n){var r=n.snapshot,e=n.prevKey,i=n.event,o=r.key,a=d(t,o),u=function(e,n){if(null==n)return 0;var t=d(e,n);return-1===t?e.length:t+1}(t,e||void 0);switch(i){case v.ListenEvent.value:if(n.snapshot&&n.snapshot.exists()){var s=null;n.snapshot.forEach(function(e){var n={snapshot:e,event:v.ListenEvent.value,prevKey:s};return s=e.key,t=h(t,[n]),!1})}return t;case v.ListenEvent.added:if(-1<a){var l=t[a-1];(l&&l.snapshot.key||null)!==e&&(t=t.filter(function(e){return e.snapshot.key!==r.key})).splice(u,0,n)}else{if(null==e)return h([n],t);(t=t.slice()).splice(u,0,n)}return t;case v.ListenEvent.removed:return t.filter(function(e){return e.snapshot.key!==r.key});case v.ListenEvent.changed:return t.map(function(e){return e.snapshot.key===o?n:e});case v.ListenEvent.moved:if(-1<a){var c=t.splice(a,1)[0];return(t=t.slice()).splice(u,0,c),t}return t;default:return t}}v.changeToData=o,v.fromRef=f,v.list=a,v.listVal=function(e,n){return a(e).pipe(c.map(function(e){return e.map(function(e){return o(e,n)})}))},v.object=function(e){return f(e,v.ListenEvent.value)},v.objectVal=function(e,n){return f(e,v.ListenEvent.value).pipe(c.map(function(e){return o(e,n)}))},v.stateChanges=function(n,e){var t=(e=i(e)).map(function(e){return f(n,e)});return l.merge.apply(void 0,h(t))}}(this.rxfire=this.rxfire||{},rxjs,rxjs.operators);
//# sourceMappingURL=rxfire-database.js.map
